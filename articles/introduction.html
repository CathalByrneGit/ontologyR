<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to ontologyR • ontologyR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ontologyR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ontologyR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/datasets-and-materialization.html">Datasets and Materialization</a></li>
    <li><a class="dropdown-item" href="../articles/end-to-end-workflow.html">End-to-End Workflow: From Data to Governed Definitions</a></li>
    <li><a class="dropdown-item" href="../articles/governance-gates.html">Governance Gates and Access Control</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction to ontologyR</a></li>
    <li><a class="dropdown-item" href="../articles/transforms-and-lineage.html">Transforms and Data Lineage</a></li>
    <li><a class="dropdown-item" href="../articles/what-is-an-ontology.html">What is an Ontology? A Plain-English Guide</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CathalByrneGit/ontologyR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to ontologyR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CathalByrneGit/ontologyR/blob/main/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-problem-definitions-drift">The Problem: Definitions Drift<a class="anchor" aria-label="anchor" href="#the-problem-definitions-drift"></a>
</h2>
<p>Most data problems aren’t about bad data—they’re about <strong>bad
definitions</strong>.</p>
<p>When a dashboard says “X patients are ready for discharge”, what it’s
really showing is not reality, but a <strong>rule</strong>. That rule
might be:</p>
<blockquote>
<p>“A patient is ready for discharge if there is no planned intervention
in the next 24 hours.”</p>
</blockquote>
<p>This seems reasonable. Until it becomes a target.</p>
<p>Once a definition is used for performance management, people adapt to
it. Staff may record interventions more cautiously, delay documentation,
or reinterpret what “planned” means. The definition hasn’t changed, but
what it measures has.</p>
<p>This is <strong>ontology drift</strong>: the gradual divergence
between what a definition claims to measure and what it actually
measures.</p>
</div>
<div class="section level2">
<h2 id="the-solution-evidence-based-definitions">The Solution: Evidence-Based Definitions<a class="anchor" aria-label="anchor" href="#the-solution-evidence-based-definitions"></a>
</h2>
<p><code>ontologyR</code> treats definitions as <strong>hypotheses, not
decrees</strong>. The core idea is simple:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Version definitions</strong> — never overwrite them</li>
<li>
<strong>Audit definitions</strong> — sample cases and check if the
definition matches reality</li>
<li>
<strong>Detect drift</strong> — track disagreement rates over
time</li>
<li>
<strong>Govern with evidence</strong> — use audit data to inform
adoption and deprecation</li>
</ol>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/CathalByrneGit/ontologyR" class="external-link">ontologyR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Connect to an ontology database</span></span>
<span><span class="fu"><a href="../reference/ont_connect.html">ont_connect</a></span><span class="op">(</span><span class="st">":memory:"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># First, we need some data to define concepts against</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html" class="external-link">dbWriteTable</a></span><span class="op">(</span><span class="fu"><a href="../reference/ont_get_connection.html">ont_get_connection</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"encounters"</span>, <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  encounter_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E1"</span>, <span class="st">"E2"</span>, <span class="st">"E3"</span>, <span class="st">"E4"</span>, <span class="st">"E5"</span><span class="op">)</span>,</span>
<span>  patient_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">42</span>, <span class="fl">70</span>, <span class="fl">65</span>, <span class="fl">55</span><span class="op">)</span>,</span>
<span>  planned_intervention_24h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  arrangements_confirmed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Register the object type (maps logical name to physical table)</span></span>
<span><span class="fu"><a href="../reference/ont_register_object.html">ont_register_object</a></span><span class="op">(</span></span>
<span>  object_type <span class="op">=</span> <span class="st">"Encounter"</span>,</span>
<span>  table_name <span class="op">=</span> <span class="st">"encounters"</span>,</span>
<span>  pk_column <span class="op">=</span> <span class="st">"encounter_id"</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"A patient encounter or visit"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define a concept</span></span>
<span><span class="fu"><a href="../reference/ont_define_concept.html">ont_define_concept</a></span><span class="op">(</span></span>
<span>  concept_id <span class="op">=</span> <span class="st">"ready_for_discharge"</span>,</span>
<span>  object_type <span class="op">=</span> <span class="st">"Encounter"</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"Patient is clinically ready to leave hospital"</span>,</span>
<span>  owner_domain <span class="op">=</span> <span class="st">"patient_flow"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add version 1: simple proxy definition</span></span>
<span><span class="fu"><a href="../reference/ont_add_version.html">ont_add_version</a></span><span class="op">(</span></span>
<span>  concept_id <span class="op">=</span> <span class="st">"ready_for_discharge"</span>,</span>
<span>  scope <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  version <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sql_expr <span class="op">=</span> <span class="st">"NOT planned_intervention_24h"</span>,</span>
<span>  status <span class="op">=</span> <span class="st">"active"</span>,</span>
<span>  rationale <span class="op">=</span> <span class="st">"Operational proxy: no planned interventions in next 24h"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Evaluate the concept</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ont_evaluate.html">ont_evaluate</a></span><span class="op">(</span><span class="st">"ready_for_discharge"</span>, <span class="st">"flow"</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 5</span></span>
<span><span class="co">#&gt;   encounter_id patient_age planned_intervention_24h arrangements_confirmed concept_value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;              &lt;dbl&gt; &lt;lgl&gt;                    &lt;lgl&gt;                  &lt;lgl&gt;        </span></span>
<span><span class="co">#&gt; 1 E1                    80 TRUE                     FALSE                  FALSE        </span></span>
<span><span class="co">#&gt; 2 E2                    42 FALSE                    TRUE                   TRUE         </span></span>
<span><span class="co">#&gt; 3 E3                    70 FALSE                    FALSE                  TRUE         </span></span>
<span><span class="co">#&gt; 4 E4                    65 TRUE                     TRUE                   FALSE        </span></span>
<span><span class="co">#&gt; 5 E5                    55 FALSE                    TRUE                   TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-audit-loop">The Audit Loop<a class="anchor" aria-label="anchor" href="#the-audit-loop"></a>
</h2>
<p>The key innovation is the <strong>audit loop</strong>: regularly
sample cases that the system says meet a definition, have humans check
if that’s actually true, and track the disagreement rate.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample cases for audit</span></span>
<span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ont_sample_for_audit.html">ont_sample_for_audit</a></span><span class="op">(</span></span>
<span>  concept_id <span class="op">=</span> <span class="st">"ready_for_discharge"</span>,</span>
<span>  scope <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  concept_value <span class="op">=</span> <span class="cn">TRUE</span>  </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># After human review, record judgments</span></span>
<span><span class="co"># (In practice, this would come from a review form or clinical system)</span></span>
<span><span class="fu"><a href="../reference/ont_record_audit.html">ont_record_audit</a></span><span class="op">(</span></span>
<span>  concept_id <span class="op">=</span> <span class="st">"ready_for_discharge"</span>,</span>
<span>  scope <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  version <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  object_key <span class="op">=</span> <span class="st">"E2"</span>,</span>
<span>  system_value <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  reviewer_value <span class="op">=</span> <span class="cn">TRUE</span>,  <span class="co"># Reviewer agrees</span></span>
<span>  reviewer_id <span class="op">=</span> <span class="st">"dr_smith"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ont_record_audit.html">ont_record_audit</a></span><span class="op">(</span></span>
<span>  concept_id <span class="op">=</span> <span class="st">"ready_for_discharge"</span>,</span>
<span>  scope <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  version <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  object_key <span class="op">=</span> <span class="st">"E3"</span>,</span>
<span>  system_value <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  reviewer_value <span class="op">=</span> <span class="cn">FALSE</span>,  <span class="co"># Reviewer disagrees!</span></span>
<span>  reviewer_id <span class="op">=</span> <span class="st">"dr_smith"</span>,</span>
<span>  notes <span class="op">=</span> <span class="st">"Patient needs social work assessment"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check audit summary</span></span>
<span><span class="fu"><a href="../reference/ont_audit_summary.html">ont_audit_summary</a></span><span class="op">(</span><span class="st">"ready_for_discharge"</span>, <span class="st">"flow"</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; ── Audit Summary: ready_for_discharge@flow v1 ───────────────────────────</span></span>
<span><span class="co">#&gt; ℹ Total audits: 2</span></span>
<span><span class="co">#&gt; ℹ Agreements: 1 (50%)</span></span>
<span><span class="co">#&gt; ℹ Disagreements: 1 (50%)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="detecting-drift">Detecting Drift<a class="anchor" aria-label="anchor" href="#detecting-drift"></a>
</h2>
<p>With enough audit data, drift becomes detectable:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check for drift (threshold-based)</span></span>
<span><span class="fu"><a href="../reference/ont_detect_drift.html">ont_detect_drift</a></span><span class="op">(</span></span>
<span>  concept_id <span class="op">=</span> <span class="st">"ready_for_discharge"</span>,</span>
<span>  scope <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.15</span>,      <span class="co"># Alert if &gt;15% disagreement</span></span>
<span>  min_audits <span class="op">=</span> <span class="fl">10</span>,       <span class="co"># Need at least 10 audits</span></span>
<span>  window_days <span class="op">=</span> <span class="fl">30</span>       <span class="co"># Look at last 30 days</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get drift status across all concepts</span></span>
<span><span class="fu"><a href="../reference/ont_drift_status.html">ont_drift_status</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; ── Drift Status Summary ─────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; ✓ ready_for_discharge@flow v1: OK</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="governance-actions">Governance Actions<a class="anchor" aria-label="anchor" href="#governance-actions"></a>
</h2>
<p>When drift is detected, the package enforces evidence-based
governance:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Can't deprecate a version with open drift events</span></span>
<span><span class="fu"><a href="../reference/ont_deprecate_version.html">ont_deprecate_version</a></span><span class="op">(</span></span>
<span>  <span class="st">"ready_for_discharge"</span>, <span class="st">"flow"</span>, <span class="fl">1</span>,</span>
<span>  deprecated_by <span class="op">=</span> <span class="st">"data_team"</span>,</span>
<span>  rationale <span class="op">=</span> <span class="st">"Replacing with v2"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: Cannot deprecate: 1 open drift event(s) exist.</span></span>
<span><span class="co">#&gt; ℹ Resolve drift events first or use `force = TRUE`.</span></span>
<span></span>
<span><span class="co"># Check policy before taking action</span></span>
<span><span class="fu"><a href="../reference/ont_check_policy.html">ont_check_policy</a></span><span class="op">(</span><span class="st">"deprecate"</span>, <span class="st">"ready_for_discharge"</span>, <span class="st">"flow"</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✖ Action BLOCKED:</span></span>
<span><span class="co">#&gt; • 1 open drift event(s) must be resolved first</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="version-comparison">Version Comparison<a class="anchor" aria-label="anchor" href="#version-comparison"></a>
</h2>
<p>Compare how different definition versions classify the same
cases:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add a refined version</span></span>
<span><span class="fu"><a href="../reference/ont_add_version.html">ont_add_version</a></span><span class="op">(</span></span>
<span>  concept_id <span class="op">=</span> <span class="st">"ready_for_discharge"</span>,</span>
<span>  scope <span class="op">=</span> <span class="st">"flow"</span>,</span>
<span>  version <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  sql_expr <span class="op">=</span> <span class="st">"NOT planned_intervention_24h AND arrangements_confirmed"</span>,</span>
<span>  status <span class="op">=</span> <span class="st">"draft"</span>,</span>
<span>  rationale <span class="op">=</span> <span class="st">"Added arrangements requirement based on audit findings"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare versions</span></span>
<span><span class="fu"><a href="../reference/ont_compare_versions.html">ont_compare_versions</a></span><span class="op">(</span><span class="st">"ready_for_discharge"</span>, <span class="st">"flow"</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; ── Comparison: ready_for_discharge@flow v1 vs v2 ────────────────────────</span></span>
<span><span class="co">#&gt; ℹ Total objects: 5</span></span>
<span><span class="co">#&gt; ℹ Agreement: 3 (60%)</span></span>
<span><span class="co">#&gt; ℹ Disagreement: 2 (40%)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-principles">Key Principles<a class="anchor" aria-label="anchor" href="#key-principles"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<strong>Definitions are hypotheses</strong> — they should be tested,
not assumed</li>
<li>
<strong>Disagreement is evidence</strong> — audit mismatches are
data, not errors</li>
<li>
<strong>Drift is measurable</strong> — track disagreement rates over
time</li>
<li>
<strong>Governance follows evidence</strong> — block actions on
drifting definitions</li>
<li>
<strong>Coexistence over replacement</strong> — multiple versions
can be active for comparison</li>
</ol>
</div>
<div class="section level2">
<h2 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<ul>
<li>See <code><a href="../articles/what-is-an-ontology.html">vignette("what-is-an-ontology")</a></code> for a conceptual
overview with analogies</li>
<li>See <code><a href="../articles/datasets-and-materialization.html">vignette("datasets-and-materialization")</a></code> for
registering datasets and materializing concepts</li>
<li>See <code><a href="../articles/transforms-and-lineage.html">vignette("transforms-and-lineage")</a></code> for building
data pipelines with lineage tracking</li>
<li>See <code><a href="../articles/governance-gates.html">vignette("governance-gates")</a></code> for access control and
quality gates</li>
<li>See <code><a href="../articles/end-to-end-workflow.html">vignette("end-to-end-workflow")</a></code> for a complete
worked example</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cathal Byrne.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
